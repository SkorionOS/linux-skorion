From e31cf650b9b864b4acc87e1dad62fad331b79adc Mon Sep 17 00:00:00 2001
From: honjow <honjow311@gmail.com>
Date: Sun, 31 Aug 2025 22:59:47 +0800
Subject: [PATCH 1/2] Revert "drm/amd/display: enable tf_blend if supported by
 mpc"

This reverts commit 7726cbdc3bc29ef3c15bbffaeb536244b2f157ed.
---
 drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_plane.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_plane.c b/drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_plane.c
index eb801c77feed..5902eb8cf119 100644
--- a/drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_plane.c
+++ b/drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_plane.c
@@ -1608,7 +1608,6 @@ dm_atomic_plane_attach_color_mgmt_properties(struct amdgpu_display_manager *dm,
 {
 	struct amdgpu_mode_info mode_info = dm->adev->mode_info;
 	struct dpp_color_caps dpp_color_caps = dm->dc->caps.color.dpp;
-	struct mpc_color_caps mpc_color_caps = dm->dc->caps.color.mpc;
 
 	/* Check HW color pipeline capabilities on DPP block (pre-blending)
 	 * before exposing related properties.
@@ -1630,7 +1629,7 @@ dm_atomic_plane_attach_color_mgmt_properties(struct amdgpu_display_manager *dm,
 				   AMDGPU_HDR_MULT_DEFAULT);
 
 	/* Only enable plane CTM if both DPP and MPC gamut remap is available. */
-	if (mpc_color_caps.gamut_remap)
+	if (dm->dc->caps.color.mpc.gamut_remap)
 		drm_object_attach_property(&plane->base,
 					   dm->adev->mode_info.plane_ctm_property, 0);
 
@@ -1650,7 +1649,7 @@ dm_atomic_plane_attach_color_mgmt_properties(struct amdgpu_display_manager *dm,
 					   MAX_COLOR_3DLUT_SIZE);
 	}
 
-	if (dpp_color_caps.ogam_ram || mpc_color_caps.ogam_ram) {
+	if (dpp_color_caps.ogam_ram) {
 		drm_object_attach_property(&plane->base,
 					   mode_info.plane_blend_lut_property, 0);
 		drm_object_attach_property(&plane->base,
-- 
2.51.0

